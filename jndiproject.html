<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd";>
<!--

    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements. See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License. You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
<html>
  <head>
    <link type="text/css" rel="stylesheet"
href="http://incubator.apache.org/aries/resources/site.css";></link>
    <script src="http://incubator.apache.org/aries/resources/space.js";
type="text/javascript"></script>
<meta name="keywords" content="..."/>
<meta name="description" content="..." />
    <title>
		Apache Aries - JNDIProject
    </title>
  </head>
<body onload="init()">

<table width="100%" cellpadding="0" cellspacing="0">
  <tr width="100%">
    <td id="cell-0-0" colspan="2">&nbsp;</td>
    <td id="cell-0-1">&nbsp;</td>
    <td id="cell-0-2" colspan="2">&nbsp;</td>
  </tr>
  <tr width="100%">
    <td id="cell-1-0">&nbsp;</td>
    <td id="cell-1-1">&nbsp;</td>
    <td id="cell-1-2">
      <div style="padding: 5px;">
        <div id="banner">
          <!-- Banner -->
			<table border="0" cellpadding="0" cellspacing="0" width="100%">
				<tr>
					<td align="left" class="topbardiv" nowrap="">
						<a href="http://incubator.apache.org/aries/" title="Apache Aries (incubating)"> <img border="0" src="http://incubator.apache.org/aries/images/Arieslogo_Horizontal.gif"> </a>
					</td>
					<td align="right" nowrap="">
						<a href="http://www.apache.org/" title="The Apache Software Foundation"> <img border="0" src="http://incubator.apache.org/aries/images/apache-incubator-logo.png"> </a>
      				</td>
				</tr>
			</table>
          <!-- Banner -->
        </div>
      </div>
      <div id="top-menu">
        <table border="0" cellpadding="1" cellspacing="0" width="100%">
          <tr>
            <td>
              <div align="left">
                <!-- Breadcrumbs -->
                <!-- Breadcrumbs -->
              </div>
            </td>
            <td>
              <div align="right">
                <!-- Quicklinks -->
					<DIV style="padding: 5px 5px 0px 25px;">
						<FORM action="http://www.google.com/search" method="get" style="font-size: 10px;">
						<A href="http://www.apache.org/licenses/LICENSE-2.0.html" class="external-link" rel="nofollow">License</A> <A href="sitemap.html" title="SiteMap">Site Map</A> 
						<INPUT name="ie" type="hidden" value="UTF-8"></INPUT>
						<INPUT name="oe" type="hidden" value="UTF-8"></INPUT>
						<INPUT maxlength="255" name="q" size="15" type="text" value></INPUT>
						<INPUT name="btnG" type="submit" value="Search"></INPUT>
						<INPUT name="domains" type="hidden" value="incubator.apache.org/aries"></INPUT>
						<INPUT name="sitesearch" type="hidden" value="incubator.apache.org/aries"></INPUT>
						</FORM>
					</DIV>
                <!-- Quicklinks -->
              </div>
            </td>
          </tr>
        </table>
      </div>
    </td>
    <td id="cell-1-3">&nbsp;</td>
    <td id="cell-1-4">&nbsp;</td>
  </tr>
  <tr width="100%">
    <td id="cell-2-0" colspan="2">&nbsp;</td>
    <td id="cell-2-1">
      <table>
        <tr height="100%" valign="top">
          <td height="100%">
            <div id="wrapper-menu-page-right">
              <div id="wrapper-menu-page-top">
                <div id="wrapper-menu-page-bottom">
                  <div id="menu-page">
                    <!-- NavigationBar -->
					<ul>
<li><h3><a href="overview.html">Overview</a></h3><ul>
<li><h4><a href="boardreports.html">Board Reports</a></h4></li>
<li><h4><a href="sitemap.html">Site Map</a></h4></li>
</ul>
</li>
<li><h3><a href="documentation.html">Documentation</a></h3><ul>
<li><h4><a href="ariesprogrammingmodel.html">Programming Model</a></h4></li>
<li><h4><a href="pointerstoosgispecifications.html">Pointers to OSGi specs</a></h4></li>
<li><h4><a href="integrators-guide.html">Integrators Guide</a></h4></li>
<li><h4><a href="articles.html">Articles</a></h4></li>
<li><h4><a href="https://svn.apache.org/repos/asf/incubator/aries/slides/">Slides</a></h4></li>
<li><h4><a href="tutorials.html">Tutorials</a></h4></li>
</ul>
</li>
<li><h3><a href="downloads.html">Downloads</a></h3></li>
<li><h3><a href="community.html">Community</a></h3><ul>
<li><h4><a href="gettinginvolved.html">Getting Involved</a></h4></li>
<li><h4><a href="people.html">Who we are</a></h4></li>
<li><h4><a href="mailinglists.html">Mailing lists</a></h4></li>
<li><h4><a href="http://blogs.apache.org/aries/">Aries Group Blog</a></h4></li>
</ul>
</li>
<li><h3><a href="development.html">Development</a></h3><ul>
<li><h4><a href="https://svn.apache.org/repos/asf/incubator/aries/.html">Source Control </a></h4></li>
<li><h4><a href="https://issues.apache.org/jira/browse/aries.html">Bug Tracking</a></h4></li>
<li><h4><a href="buildingaries.html">Building Aries </a></h4></li>
<li><h4><a href="releasingaries.html">Releasing Aries </a></h4></li>
<li><h4><a href="compliancetesting.html">OSGi Compliance Tests </a></h4></li>
<li><h4><a href="http://hudson.zones.apache.org/hudson/.html">Build System</a></h4></li>
<li><h4><a href="maintainingthewebpages.html">Web Site Maintenance </a></h4></li>
</ul>
</li>
<li><h3><a href="modules.html">Modules</a></h3><ul>
<li><h4><a href="samples.html">Samples</a></h4></li>
<li><h4><a href="blueprint.html">Blueprint</a></h4></li>
<li><h4><a href="jndiproject.html">JNDI</a></h4></li>
<li><h4><a href="jpaproject.html">JPA</a></h4></li>
<li><h4><a href="applications.html">Applications</a></h4></li>
<li><h4><a href="transactionsproject.html">Transactions</a></h4></li>
<li><h4><a href="-ebamavenpluginproject.html">EBA Maven Plugin </a></h4></li>
<li><h4><a href="spi-fly.html">SPI Fly</a></h4></li>
</ul>
</li>
<li><h3> <a href="sponsorship.html">Sponsorship</a></h3></li>
</ul> 
                    <!-- NavigationBar -->
                  </div>
                </div>
              </div>
            </div>
          </td>
          <td height="100%" width="100%">
            <!-- Content -->
            <div class="wiki-content"><p><a name="JNDIProject-Overview"></a></p>
<h1 id="jndi">JNDI</h1>
<p>The Aries JNDI project aims to provide a fully compliant implementation of
the OSGi Alliance JNDI Service Specification. This specification details
how to advertise InitialContextFactory and ObjectFactories in an OSGi
environment. It also defines how to obtain services from the service
registry via JNDI.</p>
<p><a name="JNDIProject-ServiceRegistryaccessfromJNDI"></a></p>
<h2 id="service_registry_access_from_jndi">Service Registry access from JNDI</h2>
<p>The OSGi service registry provides a centralised register/query capability
for OSGi services. A common pattern outside of OSGi is to make use of the
JNDI API to access services from a directory system. The OSGi service
registry can be viewed as an example of such a system. The Aries JNDI
project provides two URL lookup mechanisms via JNDI that can be used to
access the service registry.</p>
<p><a name="JNDIProject-osgi:service"></a></p>
<h2 id="osgiservice">osgi:service</h2>
<p>The osgi:service lookup scheme is defined by the JNDI Service Specification
and follows the scheme:</p>
<div class="codehilite"><pre><span class="err">osgi:service/&lt;interface&gt;[/&lt;filter&gt;](/&lt;filter&gt;.html)</span>
</pre></div>


<p>The interface part is an interface name, like javax.sql.DataSource, or
javax.jms.ConnectionFactory. The filter allows selection based on the
properties of the service.</p>
<p>This example:</p>
<div class="codehilite"><pre><span class="n">Context</span> <span class="n">ctx</span> <span class="o">=</span> <span class="k">new</span> <span class="n">InitialContext</span><span class="p">();</span>

<span class="n">Runnable</span> <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">Runnable</span><span class="p">)</span><span class="n">ctx</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="s">&quot;osgi:service/java.lang.Runnable&quot;</span><span class="p">);</span>
</pre></div>


<p>is equivalent to this code written to the OSGi service registry API.</p>
<div class="codehilite"><pre><span class="n">BundleContext</span> <span class="n">ctx</span> <span class="o">=</span> <span class="n">getABundleContext</span><span class="p">();</span>
<span class="n">ServiceReference</span> <span class="nb">ref</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">getServiceReference</span><span class="p">(</span><span class="s">&quot;java.lang.Runnable&quot;</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">ref</span> <span class="o">!=</span> <span class="n">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Runnable</span> <span class="n">r</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">getService</span><span class="p">(</span><span class="nb">ref</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>


<p>Lets say you wanted to filter for a Runnable with a property called <em>fred</em>
which was mapped to <em>wilma</em>. You could write</p>
<div class="codehilite"><pre><span class="n">Context</span> <span class="n">ctx</span> <span class="o">=</span> <span class="k">new</span> <span class="n">InitialContext</span><span class="p">();</span>

<span class="n">Runnable</span> <span class="n">r</span> <span class="o">=</span>
<span class="p">(</span><span class="n">Runnable</span><span class="p">)</span><span class="n">ctx</span><span class="o">.</span><span class="n">lookup</span><span class="p">(</span><span class="s">&quot;osgi:service/java.lang.Runnable/(fred=wilma)&quot;</span><span class="p">);</span>
</pre></div>


<p>which is equivalent to:</p>
<div class="codehilite"><pre><span class="n">BundleContext</span> <span class="n">ctx</span> <span class="o">=</span> <span class="n">getABundleContext</span><span class="p">();</span>
<span class="n">ServiceReference</span><span class="o">[]</span><span class="p">(</span><span class="o">.</span><span class="n">html</span><span class="p">)</span>
 <span class="n">refs</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">getServiceReference</span><span class="p">(</span><span class="s">&quot;java.lang.Runnable&quot;</span><span class="p">,</span> <span class="s">&quot;(fred=wilma)&quot;</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">refs</span> <span class="o">!=</span> <span class="n">null</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">Runnable</span> <span class="n">r</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">getService</span><span class="p">(</span><span class="n">refs</span><span class="p">[</span><span class="n">refs</span><span class="o">.</span><span class="nb">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">](</span><span class="n">refs</span><span class="o">.</span><span class="nb">length</span><span class="o">---</span><span class="mi">1</span><span class="o">.</span><span class="n">html</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>


<p>}</p>
<p>The osgi:service namepsace returns proxies, so if the Runnable was
unregistered the proxy would switch to an equivalent alternative. If no
such alternative exists then an org.osgi.framework.ServiceException with a
type of ServiceException.UNREGISTERED.</p>
<p><a name="JNDIProject-osgi:servicelist"></a></p>
<h2 id="osgiservicelist">osgi:servicelist</h2>
<p>It is possible that there are multiple services in the registry that match.
In this case the osgi:servicelist lookup scheme can be used. It has the
same format as osgi:service, but it is designed to return multiple.</p>
<p><a name="JNDIProject-aries:services"></a></p>
<h2 id="ariesservices">aries:services</h2>
<p>The aries:services scheme works in the same way as the osgi:service scheme,
but does not perform proxying. You get the actual object back. Care must be
taken with this approach as the service could be unregistered, but the
client cannot tell to stop using it. As a result it should only be used if
the service is to be used for a short period of time. In addition their is
no way to indicate that the client is no longer using the service, so clean
up cannot occur.</p>
<p><a name="JNDIProject-MoreInformation"></a></p>
<h2 id="more_information">More Information</h2>
<p>For more information, check out section "126 JNDI Services Specification
Version 1.0" in the "OSGi Service Platform Enterprise Specification,
Release 4, Version 4.2" available for public download from the <a href="http://www.osgi.org/Download/Release4V42">OSGi Alliance</a>
.</p></div>
            <!-- Content -->
          </td>
        </tr>
      </table>
   </td>
   <td id="cell-2-2" colspan="2">&nbsp;</td>
  </tr>
  <tr width="100%">
   <td id="cell-3-0">&nbsp;</td>
   <td id="cell-3-1">&nbsp;</td>
   <td id="cell-3-2">
     <div id="footer">
       <!-- Footer -->
       <div id="site-footer">
         <a href="http://incubator.apache.org/aries/privacy-policy.html";>Privacy
Policy</a> 
       </div>
       <!-- Footer -->
     </div>
   </td>
   <td id="cell-3-3">&nbsp;</td>
   <td id="cell-3-4">&nbsp;</td>
  </tr>
  <tr width="100%">
    <td id="cell-4-0" colspan="2">&nbsp;</td>
    <td id="cell-4-1">&nbsp;</td>
    <td id="cell-4-2" colspan="2">&nbsp;</td>
  </tr>
</table>
</body>
</html> 
