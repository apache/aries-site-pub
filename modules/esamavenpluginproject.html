<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd";>
<!--
    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements. See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License. You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
<html>
  <head>
    <link rel="shortcut icon" href="http://aries.apache.org/images/favicon.ico"></link>
    <link type="text/css" rel="stylesheet" href="http://aries.apache.org/resources/site.css"></link>
    </script><script src="http://aries.apache.org/resources/menus.js" language="javascript" type="text/javascript"></script>
  <meta name="keywords" content="..."/>
  <meta name="description" content="..." />
    <title>
    Apache Aries - 
    </title>
  </head>
<body onload="SetMenu()">

<table width="100%" cellpadding="0" cellspacing="0">
  <tr width="100%">
    <td id="cell-0-0" colspan="2">&nbsp;</td>
    <td id="cell-0-1">&nbsp;</td>
    <td id="cell-0-2" colspan="2">&nbsp;</td>
  </tr>
  <tr width="100%">
    <td id="cell-1-0">&nbsp;</td>
    <td id="cell-1-1">&nbsp;</td>
    <td id="cell-1-2">
      <div style="padding: 5px;">
        <div id="banner">
          <!-- Banner -->
      <table border="0" cellpadding="0" cellspacing="0" width="100%">
        <tr>
          <td align="left" class="topbardiv" nowrap="">
            <a href="http://aries.apache.org/" title="Apache Aries"> <img border="0" src="http://aries.apache.org/images/Arieslogo_Horizontal.gif"> </a>
          </td>
          <td align="right" nowrap="">
            <a href="http://www.apache.org/" title="The Apache Software Foundation"> <img border="0" src="http://aries.apache.org/images/apache_feather.png"> </a>
              </td>
        </tr>
      </table>
          <!-- Banner -->
        </div>
      </div>
      <div id="top-menu">
        <table border="0" cellpadding="1" cellspacing="0" width="100%">
          <tr>
            <td>
              <div align="left">
                <!-- Breadcrumbs -->
                <!-- Breadcrumbs -->
              </div>
            </td>
            <td>
              <div align="right">
                <!-- Quicklinks -->
          <DIV style="padding: 5px 5px 0px 25px;">
            <FORM action="http://www.google.com/search" method="get" style="font-size: 10px;">
            <A href="http://www.apache.org/licenses/LICENSE-2.0.html" class="external-link" rel="nofollow">License</A> 
            <INPUT name="ie" type="hidden" value="UTF-8"></INPUT>
            <INPUT name="oe" type="hidden" value="UTF-8"></INPUT>
            <INPUT maxlength="255" name="q" size="15" type="text" value></INPUT>
            <INPUT name="btnG" type="submit" value="Search"></INPUT>
            <INPUT name="domains" type="hidden" value="aries.apache.org"></INPUT>
            <INPUT name="sitesearch" type="hidden" value="aries.apache.org"></INPUT>
            </FORM>
          </DIV>
                <!-- Quicklinks -->
              </div>
            </td>
          </tr>
        </table>
      </div>
    </td>
    <td id="cell-1-3">&nbsp;</td>
    <td id="cell-1-4">&nbsp;</td>
  </tr>
  <tr width="100%">
    <td id="cell-2-0" colspan="2">&nbsp;</td>
    <td id="cell-2-1">
      <table>
        <tr height="100%" valign="top">
          <td height="100%">
            <div id="wrapper-menu-page-right">
              <div id="wrapper-menu-page-top">
                <div id="wrapper-menu-page-bottom">
                  <div id="menu-page">
                    <!-- NavigationBar -->
          <div onclick="SwitchMenu('overview')" id="overviewTitle" class="menutitle">Overview</div>

<div id="overview" class="menuitemgroup">
    <div class="menuitem">
        <a href="/overview/boardreports.html">Board Reports</a> 
    </div>
    <div class="menuitem">
        <a href="/overview/news.html">News</a> 
    </div>
</div>

<div onclick="SwitchMenu('documentation')" id="documentationTitle" class="menutitle">Documentation</div>

<div id="documentation" class="menuitemgroup">
    <div class="menuitem">
        <a href="/documentation/ariesprogrammingmodel.html">Programming Model</a> 
    </div>
    <div class="menuitem">
        <a href="/documentation/pointerstoosgispecifications.html">Pointers to OSGi specs</a> 
    </div>
    <div class="menuitem">
        <a href="/documentation/integrators-guide.html">Integrators Guide</a> 
    </div>
    <div class="menuitem">
        <a href="/documentation/articles.html">Articles</a> 
    </div>
    <div class="menuitem">
        <a href="https://svn.apache.org/repos/asf/aries/slides/">Slides</a> 
    </div>
    <div class="menuitem">
        <a href="/documentation/tutorials.html">Tutorials</a> 
    </div>
    <div class="menuitem">
        <a href="/documentation/tools.html">Tools</a> 
    </div>
</div>

<div onclick="SwitchMenu('downloads')" id="downloadsTitle" class="menutitle">Downloads</div>

<div id="downloads" class="menuitemgroup">
    <div class="menuitem">
        <a href="/downloads/currentrelease.html">Current Release</a> 
    </div>
    <div class="menuitem">
        <a href="/downloads/testresults.html">Compliance Tests</a> 
    </div>
    <div class="menuitem">
        <a href="/downloads/archived-releases.html">Archived Releases</a> 
    </div>
</div>

<div onclick="SwitchMenu('community')" id="communityTitle" class="menutitle">Community</div>

<div id="community" class="menuitemgroup">
    <div class="menuitem">
        <a href="/community/overview.html">Community</a> 
    </div>
    <div class="menuitem">
        <a href="/community/gettinginvolved.html">Getting Involved</a> 
    </div>
    <div class="menuitem">
        <a href="/community/people.html">Who we are</a> 
    </div>
    <div class="menuitem">
        <a href="/community/mailinglists.html">Mailing lists</a> 
    </div>
        <div class="menuitem">
                <a href="/community/logos.html">Logos for Users</a>
        </div>
</div>

<div onclick="SwitchMenu('development')" id="developmentTitle" class="menutitle">Development</div>

<div id="development" class="menuitemgroup">
    <div class="menuitem">
        <a href="https://svn.apache.org/repos/asf/aries/">Source Control</a> 
    </div>
    <div class="menuitem">
        <a href="https://issues.apache.org/jira/browse/ARIES">Bug Tracking</a> 
    </div>
    <div class="menuitem">
        <a href="/development/buildingaries.html">Building Aries </a> 
    </div>
    <div class="menuitem">
        <a href="/development/maven-best-practice-in-aries.html">Maven best practice</a> 
    </div>
    <div class="menuitem">
        <a href="/development/moduledependencies.html">Module Dependencies</a> 
    </div>
    <div class="menuitem">
        <a href="/development/releasingaries.html">Releasing Aries </a> 
    </div>
    <div class="menuitem">
        <a href="/development/verifyingrelease.html">Verifying Release artifacts</a> 
    </div>
    <div class="menuitem">
        <a href="/development/compliancetesting.html">OSGi Compliance Tests </a> 
    </div>
    <div class="menuitem">
        <a href="https://builds.apache.org/hudson/">Build System</a> 
    </div>
    <div class="menuitem">
        <a href="/development/maintainingthewebpages.html">Web Site Maintenance </a> 
    </div>
        <div class="menuitem">
        <a href="/development/versionpolicy.html">OSGi Version Policy </a> 
    </div>
</div>

<div onclick="SwitchMenu('modules')" id="modulesTitle" class="menutitle">Modules</div>

<div id="modules" class="menuitemgroup">
    <div class="menuitem">
        <a href="/modules/samples.html">Samples</a> 
    </div>
    <div class="menuitem">
        <a href="/modules/blueprint.html">Blueprint</a> 
    </div>
    <div class="menuitem">
        <a href="/modules/blueprint-maven-plugin.html">blueprint-maven-plugin</a> 
    </div>
    <div class="menuitem">
        <a href="/modules/blueprintannotation.html">Blueprint Annotations</a>
    </div>
    <div class="menuitem">
        <a href="/modules/blueprintnoosgi.html">Blueprint No-OSGi</a>
    </div>
    <div class="menuitem">
        <a href="/modules/blueprintweb.html">Blueprint Web</a>
    </div>
    <div class="menuitem">
        <a href="/modules/jmx.html">JMX</a> 
    </div>
    <div class="menuitem">
        <a href="/modules/jndiproject.html">JNDI</a> 
    </div>
    <div class="menuitem">
        <a href="/modules/jpaproject.html">JPA</a> 
    </div>
    <div class="menuitem">
        <a href="/modules/applications.html">Applications</a> 
    </div>
    <div class="menuitem">
        <a href="/modules/transactionsproject.html">Transactions</a> 
    </div>
    <div class="menuitem">
        <a href="/modules/ebamavenpluginproject.html">EBA Maven Plugin </a> 
    </div>
    <div class="menuitem">
        <a href="/modules/esamavenpluginproject.html">ESA Maven Plugin </a> 
    </div>
    <div class="menuitem">
        <a href="/modules/spi-fly.html">SPI Fly</a> 
    </div>
</div>

<div onclick="SwitchMenu('sponsorship')" id="sponsorshipTitle" class="menutitle">Sponsorship</div>

<div id="sponsorship" class="menuitemgroup">
    <div class="menuitem">
        <a href="http://www.apache.org/foundation/thanks.html">Thanks</a> 
    </div>
    <div class="menuitem">
        <a href="http://www.apache.org/foundation/sponsorship.html">Sponsoring Apache</a> 
    </div>
</div>
                    <!-- NavigationBar -->
                  </div>
                </div>
              </div>
            </div>
          </td>
          <td height="100%" width="100%">
            <!-- Content -->
            <div class="wiki-content"><p><a name="ESAMavenPluginProject-ESAMavenPlugin"></a></p>
<h1 id="esa-maven-plugin">ESA Maven Plugin</h1>
<p>This page describes the <code>esa-maven-plugin</code> version 1.0.0 which is available from Maven Central.</p>
<p>The ESA Maven Plugin provides the ability to generate ESA archives using
Maven.  The ESA archive format is defined in the Subsystems Service Specification which was part of <a href="http://www.osgi.org/Specifications/HomePage">OSGi Enterprise R5</a>.  An ESA archive can optionally contain an Subsystem manifest
(<code>SUBSYSTEM.MF</code>).  This can be added in one of two ways</p>
<ol>
<li>Hand written and added into the archive.</li>
<li>Generated based on pom configuration.</li>
</ol>
<p><a name="ESAMavenPluginProject-UsingthePlugin"></a></p>
<h2 id="using-the-plugin">Using the Plugin</h2>
<p>The plugin is included by as follows:</p>
<div class="codehilite"><pre><span class="nt">&lt;project&gt;</span>
  ...
  <span class="nt">&lt;packaging&gt;</span>esa<span class="nt">&lt;/packaging&gt;</span> <span class="c">&lt;!-- set packaging type to esa --&gt;</span>

  <span class="nt">&lt;build&gt;</span>
    <span class="nt">&lt;plugins&gt;</span>
      <span class="nt">&lt;plugin&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.apache.aries<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>esa-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>1.0.0<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;extensions&gt;</span>true<span class="nt">&lt;/extensions&gt;</span>
      <span class="nt">&lt;/plugin&gt;</span>
    <span class="nt">&lt;/plugins&gt;</span>
  <span class="nt">&lt;/build&gt;</span>
<span class="nt">&lt;/project&gt;</span>
</pre></div>


<p>By default it will not generate a manifest, so in the above example it will
attempt to copy a pre-defined <code>SUBSYSTEM.MF</code> from
<code>src/main/resources/META-INF</code>.  If that file does not exist, then no
Subsystem manifest will be included.</p>
<p><a name="ESAMavenPluginProject-GeneratinganSUBSYSTEM.MF"></a></p>
<h2 id="generating-an-subsystemmf">Generating an SUBSYSTEM.MF</h2>
<p>The following example <code>pom.xml</code> shows how to get the plugin to generate an
<code>SUBSYSTEM.MF</code> based on the pom configuration:</p>
<div class="codehilite"><pre><span class="nt">&lt;project&gt;</span>
  <span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>

  <span class="nt">&lt;groupId&gt;</span>org.something<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>esa-maven-plugin-test<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>1.0.0-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
  <span class="nt">&lt;packaging&gt;</span>esa<span class="nt">&lt;/packaging&gt;</span>

  <span class="nt">&lt;dependencies&gt;</span>
    <span class="c">&lt;!-- Put some dependencies in here --&gt;</span>
  <span class="nt">&lt;/dependencies&gt;</span>

  <span class="nt">&lt;build&gt;</span>
    <span class="nt">&lt;plugins&gt;</span>
      <span class="nt">&lt;plugin&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.apache.aries<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>esa-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>1.0.0<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;extensions&gt;</span>true<span class="nt">&lt;/extensions&gt;</span>
        <span class="nt">&lt;configuration&gt;</span>
          <span class="nt">&lt;generateManifest&gt;</span>true<span class="nt">&lt;/generateManifest&gt;</span>
        <span class="nt">&lt;/configuration&gt;</span>
      <span class="nt">&lt;/plugin&gt;</span>
    <span class="nt">&lt;/plugins&gt;</span>
  <span class="nt">&lt;/build&gt;</span>
<span class="nt">&lt;/project&gt;</span>
</pre></div>


<p>The pom to subsystem manfiest header mapping is as follows:</p>
<ul>
<li>Pom &lt;groupId/&gt;.&lt;artifactId/&gt; -&gt; Subsystem-SymbolicName</li>
<li>Pom &lt;name/&gt; -&gt; Subsystem-Name</li>
<li>Pom &lt;version/&gt; -&gt; Subsystem-Version (cleaned up for OSGi)</li>
<li>Pom &lt;description/&gt; -&gt; Subsystem-Description</li>
<li>Pom &lt;dependencies/&gt; -&gt; Subsystem-Content</li>
</ul>
<p><a name="ESAMavenPluginProject-OverridingSubsystem-SymbolicName"></a></p>
<h2 id="overriding-subsystem-symbolicname">Overriding Subsystem-SymbolicName</h2>
<p>The subsystem symbolic name defaults to the
${project.groupId}.${project.artifactId}.  The following shows how to override
this:</p>
<div class="codehilite"><pre><span class="nt">&lt;configuration&gt;</span>
  <span class="nt">&lt;instructions&gt;</span>
    <span class="nt">&lt;Subsystem</span><span class="err">-SymbolicName</span><span class="nt">&gt;</span><span class="cp">${</span><span class="n">project</span><span class="o">.</span><span class="n">artifaceId</span><span class="cp">}</span><span class="nt">&lt;/Subsystem-SymbolicName&gt;</span>
  <span class="nt">&lt;/instructions&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</pre></div>


<p><a name="ESAMavenPluginProject-Archivecontent"></a></p>
<h2 id="including-bundles-in-the-archive">Including bundles in the archive</h2>
<p>By default, the archive will only include the direct dependencies of the project.  The <code>&lt;archiveContent/&gt;</code> element can be used to control the archive artifact contents.  The following shows how to include all direct and transitive dependencies.</p>
<div class="codehilite"><pre><span class="nt">&lt;configuration&gt;</span>
  <span class="nt">&lt;archiveContent&gt;</span>all<span class="nt">&lt;/archiveContent&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</pre></div>


<p>The following shows how to exclude all dependencies from the archive.  This is useful if you just want the subsystem definition and will use a bundle repository to provision the bundles during deployment.</p>
<div class="codehilite"><pre><span class="nt">&lt;configuration&gt;</span>
  <span class="nt">&lt;archiveContent&gt;</span>none<span class="nt">&lt;/archiveContent&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</pre></div>


<p>The following specifies the default of including only the direct dependencies (assumes the subsystem contents and direct dependencies are the same).</p>
<div class="codehilite"><pre><span class="nt">&lt;configuration&gt;</span>
  <span class="nt">&lt;archiveContent&gt;</span>content<span class="nt">&lt;/archiveContent&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</pre></div>


<p><a name="ESAMavenPluginProject-StartOrder"></a></p>
<h2 id="content-bundle-start-ordering">Content Bundle Start Ordering</h2>
<p>By default, the Subsystem runtime can start content bundles in any order.  The OSGi start level service is not applicable to subsystems.  You can specify the start order of the bundles based on the order in which they're expressed as dependencies in the maven pom using the following:</p>
<div class="codehilite"><pre><span class="nt">&lt;configuration&gt;</span>
  <span class="nt">&lt;startOrder&gt;</span>dependencies<span class="nt">&lt;/startOrder&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</pre></div>


<p><a name="ESAMavenPluginProject-ExistingSUBSYSTEM.MF"></a></p>
<h2 id="including-an-existing-subsystem-manifest">Including an Existing Subsystem manifest</h2>
<p>If you don't wish to generate the Subsystem manifest based on the pom configuration, you can add an existing one as follows:</p>
<div class="codehilite"><pre><span class="nt">&lt;configuration&gt;</span>
  <span class="nt">&lt;subsystemManifestFile&gt;</span><span class="cp">${</span><span class="n">basedir</span><span class="cp">}</span>/src/main/resources/OSGI-INF/SUBSYSTEM.MF<span class="nt">&lt;/subsystemManifestFile&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</pre></div>


<p><a name="ESAMavenPluginProject-OtherHeaders"></a></p>
<h2 id="including-other-headers">Including Other Headers</h2>
<p>You can add any other headers in addition to those calculated from the pom configuration.  For example, the following specifies the Subsystem Use-Bundle header and sets the Subsystem-Type to be a feature:</p>
<div class="codehilite"><pre><span class="nt">&lt;instructions&gt;</span>
    <span class="nt">&lt;Use-Bundle&gt;</span>org.apache.aries.test.Bundle;version=1.0.0-SNAPSHOT<span class="nt">&lt;/Use-Bundle&gt;</span>
    <span class="nt">&lt;Subsystem-Type&gt;</span>osgi.subsystem.feature<span class="nt">&lt;/Subsystem-Type&gt;</span>
<span class="nt">&lt;/instructions&gt;</span>
</pre></div></div>
            <!-- Content -->
          </td>
        </tr>
      </table>
   </td>
   <td id="cell-2-2" colspan="2">&nbsp;</td>
  </tr>
  <tr width="100%">
   <td id="cell-3-0">&nbsp;</td>
   <td id="cell-3-1">&nbsp;</td>
   <td id="cell-3-2">
     <div id="footer">
       <!-- Footer -->
       <div id="site-footer">
         <a href="http://aries.apache.org/privacy-policy.html";>Privacy
Policy</a> 
       </div>
       <!-- Footer -->
     </div>
   </td>
   <td id="cell-3-3">&nbsp;</td>
   <td id="cell-3-4">&nbsp;</td>
  </tr>
  <tr width="100%">
    <td id="cell-4-0" colspan="2">&nbsp;</td>
    <td id="cell-4-1">&nbsp;</td>
    <td id="cell-4-2" colspan="2">&nbsp;</td>
  </tr>
</table>
</body>
</html> 
